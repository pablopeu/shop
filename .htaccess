# Security: Block access to sensitive files and directories

# Block access to composer files
<FilesMatch "^composer\.(json|lock)$">
    Require all denied
</FilesMatch>

# Block access to package manager files
<FilesMatch "^package(-lock)?\.json$">
    Require all denied
</FilesMatch>

# Block access to config directory
<DirectoryMatch "^.*/config/?">
    Require all denied
</DirectoryMatch>

# Block access to data directory
<DirectoryMatch "^.*/data/?">
    Require all denied
</DirectoryMatch>

# Block access to includes directory (PHP libraries only)
<DirectoryMatch "^.*/includes/?">
    Require all denied
</DirectoryMatch>

# Block access to mcp-server directory
<DirectoryMatch "^.*/mcp-server/?">
    Require all denied
</DirectoryMatch>

# Block access to vendor directory (if exists)
<DirectoryMatch "^.*/vendor/?">
    Require all denied
</DirectoryMatch>

# Block access to node_modules (if exists)
<DirectoryMatch "^.*/node_modules/?">
    Require all denied
</DirectoryMatch>

# Block access to .env files
<FilesMatch "^\.env">
    Require all denied
</FilesMatch>

# Block access to log files
<FilesMatch "\.(log|logs)$">
    Require all denied
</FilesMatch>

# Block access to backup files
<FilesMatch "\.(bak|backup|old|orig|save|swp|tmp)$">
    Require all denied
</FilesMatch>

# Block access to SQL files
<FilesMatch "\.sql$">
    Require all denied
</FilesMatch>

# Block access to git files
<FilesMatch "^\.git">
    Require all denied
</FilesMatch>

# Block access to .htaccess itself
<Files ".htaccess">
    Require all denied
</Files>

# Block access to all hidden files (starting with .)
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Prevent directory listing
Options -Indexes

# Protect against clickjacking
Header always set X-Frame-Options "SAMEORIGIN"

# XSS Protection
Header always set X-XSS-Protection "1; mode=block"

# Prevent MIME sniffing
Header always set X-Content-Type-Options "nosniff"

# Referrer Policy
Header always set Referrer-Policy "strict-origin-when-cross-origin"
