# Security: Block access to sensitive files only

# Block access to composer files
<FilesMatch "^composer\.(json|lock)$">
    Require all denied
</FilesMatch>

# Block access to package manager files
<FilesMatch "^package(-lock)?\.json$">
    Require all denied
</FilesMatch>

# Block access to .env files
<FilesMatch "^\.env">
    Require all denied
</FilesMatch>

# Block access to log files
<FilesMatch "\.(log|logs)$">
    Require all denied
</FilesMatch>

# Block access to backup files
<FilesMatch "\.(bak|backup|old|orig|save|swp|tmp)$">
    Require all denied
</FilesMatch>

# Block access to SQL files
<FilesMatch "\.sql$">
    Require all denied
</FilesMatch>

# Block access to git files
<FilesMatch "^\.git">
    Require all denied
</FilesMatch>

# Block access to .htaccess itself
<Files ".htaccess">
    Require all denied
</Files>

# Block access to all other hidden files (starting with .)
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Prevent directory listing
Options -Indexes

# Security headers (if mod_headers is available)
<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>
